<!DOCTYPE html>
<!--
  Mini Projekt Baz Danych
  2ID14B, Przychodnia
-->
<html lang="pl">
  <head>
    <title> PRZYCHODNIA | LOGOWANIE </title>
    <meta charset="UTF-8">
	<link rel="stylesheet" href="css/m_style.css">
	<link rel="stylesheet" href="css/log_style.css">
  </head>
  <body>

    <!-- TO-DO: Styl -->
	<div class="navbar">
		<a href="index.html">
			<img src="data/img/samples/left_arrow.png" alt="back" class="back_arrow" 	/>
		</a> 
	</div>
	
	<div class="log_panel">
		<center>

		  <input type="text" placeholder="Nazwa Uzytkownika" autocomplete="off" id="loginArea"> <br>
		  <input type="password" placeholder="Haslo" autocomplete="off" id="passwdArea"> <br><br>

		  <div id="errOut"></div>

		  <a href="rejestracja"> Rejestracja</a>
		  <input type="button" value="Zaloguj" id="loginButton"> 

		</center>
	</div>
    

    
	
	<script src="js/api.js"></script>
    <script>

      dbRestrict("Jestes juz zalogowany/zalogowana!", "./konto", ["brak"]);
      
      loginButton.onclick = function(e) 
      {
        const form = {
          login: loginArea.value,
          passwd: passwdArea.value
        }
        
        dbReq((res) =>
        {
          console.log(res);
          if (res.success)
          {
            localStorage.setItem("token", res.token);
            window.location.href = './konto';
          }
          else
          {
            errOut.innerHTML = `Nie udalo sie zalogowac: ${res.err}`;
          }
        }, "zaloguj", ["user", form.login, "password", form.passwd]);
      }

    </script>

  </body>
</html>