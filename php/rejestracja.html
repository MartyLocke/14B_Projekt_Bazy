<!DOCTYPE html>
<!--
  Mini Projekt Baz Danych
  2ID14B, Przychodnia
-->
<html lang="pl">
  <head>
    <title> PRZYCHODNIA | ZAREJESTRUJ SIÄ˜ </title>
    <meta charset="UTF-8">
  </head>
  <body>

  <!-- Jako Pacjent -->

  <!-- Napisz: Uniwersalny Skrypt -->  
  <!-- generateForm() -->
  <input class="f1" type="text" placeholder="Imie" name="Imie"> <br>
  <input class="f1" type="text" placeholder="Nazwisko" name="Nazwisko"> <br> <br>

  <input class="f1" type="date" placeholder="Data Urodzenia" name="Dataurodz"> <br>

  <input class="f1" type="number" placeholder="Pesel" name="Pesel"> <br> <br>
  <input class="f1" type="text" placeholder="Miasto" name="Miasto"> <br>
  <input class="f1" type="text" placeholder="Ulica" name="Ulica"> <br>
  <input class="f1" type="text" placeholder="Nr Domu" name="Dom"> <br>
  <input class="f1" type="text" placeholder="Nr Lokalu" name="Lokal"> <br>
  <input class="f1" type="text" placeholder="Kod Pocztowy" name="Poczta"> <br><br>
  
  <input class="f1" type="text" placeholder="Nr Telefony" name="Telefon"> <br> 
  <input class="f1" type="text" placeholder="Email" name="Mail"> <br> <br>
    
  <input class="f1" type="text" placeholder="Nazwa Uzytkownika" autocomplete="off" name="Login"> <br>
  <input class="f1" type="password" placeholder="Haslo" autocomplete="off" name="Haslo"> <br>
  <br> 
    <div id="errOut"></div>
  <br>
  <input type="button" value="Zarejestruj" id="registerButton"> <br>
  <input type="checkbox"> Zgadzam sie i podpisuje cyrograf!
  

  <script src="js/api.js"></script>
  <script>
    
    dbRestrict(
      "Jestes juz zarejestrowany/zarejestrowana!", 
      "./konto", ["brak", "admin"]
    ); // ?lekarz

    registerButton.onclick = function (e)
    {
      let argList = [];
      for (let itm of document.getElementsByClassName("f1"))
      {
        argList.push(itm.name.toLowerCase());

        const strippedValue = itm.value.trim();
        if (strippedValue == '' && itm.name != 'Lokal')
        {
          errOut.innerHTML = `Pole ${itm.name} nie moze byc puste!`;
          return;
        }
        argList.push(strippedValue);
      }
      console.log(argList);

      dbReq((res) =>
      {
        if (res.success)
        {
          window.location.href = './logowanie';
        }
        else
        {
          errOut.innerHTML = `Nie udalo sie utworzyc konta: ${res.err}`;
        }
        console.log(res);
      }, "zarejestruj", argList);

    }



  </script>
  </body>
</html>